  <%# ------------------------ Header --------------------------------------- %>

<div class="mb-3 p-4" style="background-color: #a8d254; opacity: 0.5; display: flex; justify-content: center; align-items: center; position: relative;">
  <%= link_to request.referer, style: "position: absolute; left: 20px;" do %>
    <i class="fa-regular fa-circle-left fa-2xl" style="color: #000000;"></i>
  <% end %>
  <h1 class="text-center" style="margin: 0;">COMMENT / SHARE</h1>
</div>


  <%# -------------------- Recipe details------------------------------------ %>

<div class="border mx-3 p-3 mb-3">
  <h3><strong><%= @recipe.title %></strong></h3>
  <p>Prep-time : <%= @recipe.prep_time %></p>
  <p>Servings : <%= @recipe.servings %></p>
</div>

<div class="border mx-3 p-3">
  <p>Your last rating : <%= @recipe.rating %> / 5</p>

  <p>Your comments :</p>

  <% if @comments.any? %>
    <ul>
      <% @comments.each do |comment| %>
        <li>
          <strong><%= comment.created_at.strftime("%d %b %Y, %H:%M") %></strong> :
          <%= comment.content %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>No comment for this recipe.</p>
  <% end %>
</div>


  <%# --------------------------- Comment ----------------------------------- %>

<div class="d-flex justify-content-between">

  <div data-controller="toggle" class="m-3">
    <button data-action="click->toggle#fire" class="btn btn-outline-primary rounded-pill">Write comment</button>
    <div data-toggle-target="togglableElement" class="d-none">
      <%= render "form", comment: @comment, recipe: @recipe %>
    </div>
  </div>


  <%# ---------------------- Rate ------------------------------------------- %>

<div class="m-3">
  <h4>Rate This Recipe</h4>
  <%= render "form_rating", recipe: @recipe %>
</div>

  <%# ----------------------- Share ----------------------------------------- %>

  <div class="mt-3 me-3">
    <button id="share-button" class="btn btn-outline-primary rounded-pill" data-url="<%= recipe_url(@comment.recipe) %>">Share recipe</button>
  </div>

</div>


  <%# --------------- Back to home page --------------- %>

    <%= link_to "Back to home page", erase_path, class: "btn btn-dark rounded-pill mx-5" %>


  <%# -------------------- Script ------------------ %>

<script>
  const button = document.getElementById("share-button")
  button.addEventListener("click", function () {
    const message = `"Check out this recipe I just tried!" ${button.dataset.url}`;
    const whatsappURL = `https://api.whatsapp.com/send?text=${encodeURIComponent(message)}`;
    window.open(whatsappURL, "_blank");
  });
</script>
